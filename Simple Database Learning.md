# Simple Database Learning

## PART1 前言

数据库，顾名思义就是存储数据的“库”

而为什么需要数据库呢，这是因为几乎所有应用都离不开后台的“数据”，而数据该如何去“存储”，又该如何去“查找”，这都是需要经过设计的，在part1里，我想通过一些简单的设计来引入“数据库”这一概念

### 1

设计一个最简单的数据库，你把数据都存到数组里（这里以qq号为例）

| 数组索引 | qq号 |
| -------- | ---- |
| 0        | 0    |
| 1        | 1    |
| 2        | 2    |

这是存储你的qq号的，那该怎么存储你的qq昵称和各种姓名呢，当然可以再多几个数组表

| 数组索引 | 昵称       |
| -------- | ---------- |
| 0        | oldsheep   |
| 1        | oldsheepp  |
| 2        | oldsheeppp |

把qq号作为数组索引来查找与qq号关联的索引

你还可以多来几个表

性别表、等级表、好友表……

但是这会出现一些问题

简单列几点

---

当一个用户注销了qq号之后，所有数组表对应的存储空间就无效了，但是由于数组的特性，那部分地址空间还是需要分配的（相当于你在c语言里malloc了一块空间，用完了却不free/在java里新建了个对象，已经没有对它的引用了却还没被回收）

当你登录了qq后，qq需要获取一大堆数据，而这些如果都是在很多很多表里面的话，那就需要反复去读取各个数组，性能会有损耗

你想通过昵称来搜索一个用户，那你就需要在一个数组表里不断遍历……不断遍历……，查找复杂度是O(n)，这是很慢的

还有很多很多其他问题

### 2

那么可以升级一下

用c语言里的“结构体”或java里的“对象”来存储一个用户的数据

| 数组索引 | 昵称       | 等级 | ……   |
| -------- | ---------- | ---- | ---- |
| 0        | oldsheep   | 999  |      |
| 1        | oldsheepp  | 666  |      |
| 2        | oldsheeppp | 369  |      |

这样就避免了之前的第二个问题，你只需要在这张数组表里读取一次，就能获取到用户的全部数据

但是这样也会有一个问题

当你只需要其中一个或几个数据时，你读取的数组依旧会获取到该用户的全部数据，久而久之，qq号里存的数据不断增加，你要读取数据时的负载也会不断增加

### 3

继续进行升级

用多张表来存储用户数据

只存用户身份数据的表↓

| 数组索引 | 昵称     | 等级 | 性别 | 成分       | ……   |
| -------- | -------- | ---- | ---- | ---------- | ---- |
| 0        | oldsheep | 333  | 男   | 正常人     |      |
| 1        | Noooooob | 666  | 男   | 不是嘉心糖 |      |
| 2        | esph     | 999  | 男   | 二刺螈     |      |

只存用户所加群聊的表↓

| 数组索引 | qq群号1    | qq群号2   |
| -------- | ---------- | --------- |
| 0        | 1019692423 | 222865121 |
| 1        | ……         |           |
| 2        |            |           |

其实这种表结构的设计已经比较接近之后要学习的mysql数据库的表结构设计了

### others

还可以进行其他方向的升级

+ 把数组换成链表，这样就可以当用户注销身份后回收那一部分空间，当然这也会大大增加索引的难度，因为这样就不能单纯通过索引来访问一个数据了，而是要遍历链表才可以
+ 把数组换成其他数据结构，例如平衡二叉树，这样的话既能减少查找所需的时间，也能够当用户在注销身份后回收那一部分空间，但是当在存储大量数据如群聊记录时，你的树将要不断进行旋转以满足需求，这样也会耗费时间
+ 把索引换成其他值，例如为每一个qq号随机分配一个数字，这样也可以让数组表的空间腾出来

+ ……

## PART2 学习

上面只是简单的介绍了一下数据库

实际上现在正在使用的大型可用数据库远不是设计几个数组那么简单

而接下来我们将学习使用的就是一个非常经典的数据库：MySQL

至于为什么不是让你们去造一个数据库而只是学习使用，那是因为对刚入学的学生来说还太早了。。

我们20的也都没全部开始学怎么造数据库

### step1 下载安装并简单使用

在你的电脑上下载安装mysql数据库（版本无所谓）

如果安装了linux虚拟机可以试着在linux上完成

+ 创建一个名为glimmer的数据库

+ 创建一张member表，主键是什么随你自己定

  将工作室成员的基本数据写上去（例如名字，qq号，年级等等，随你写）

+ 下面根据你选的数据创表
  + 创建一张年级表，主键是年级，记得把glimmer表里的年级设成外键，数据就统计下人数吧
  + 创建一张性别表，同理
  + ……
+ 编写一些查询语句，例如通过姓名查询到某个人的数据，通过性别和年级查询某些人的数据

PS：本环节不准使用图形化界面，尽量自己通过编写sql语句实现

---

看起来step1很短，但如果完全没了解过这方面的东西的话还是要折腾一下的

### step2 图形化界面工具

在完成step1的过程中，什么数据都得在命令行里输入，比较麻烦

所以也会有些人性化的图形化工具出现，更加直观

+ 在mysql官网就能下载到的mysql workbench

+ navicat，要钱，但你可以破解(

你可以试着再用他们对建表、插入数据、查询等做操作

如果你有购买云服务器的话，试着在云服务器的mysql上配置一个账户

使得这些图形化工具能够通过该账户连接到你的数据库

---

其实你敲代码的玩意也是可以连接到数据库作为一个图形化界面工具的

vscode、idea、clion、pycharm等等都支持连接数据库，当然功能肯定没有专业的全面

可以试一试

### step3 小拓展

+ 了解一下什么叫关系型数据库，什么叫非关系型数据库

+ 了解一下什么叫sql注入，又该如何防范

+ 了解一下sql优化的一些策略

+ **小任务，思考题**

  + 请设计一些表结构，能够满足：

    几个教室需要进行租借，需要记录下租借时间、租借人员、审核人员、是否通过、用途

    是否已完成等等数据（你们自由发挥就好）

    审核人员是固定的人选，所以也需要进行记录

## PART3 其他

其实你们都可以通过使用语言来直接操作数据库，数据库本身是提供了这些功能接口的

而各种语言也都有相应的中间件来为我们提供更好的抽象接口来实现操作数据库这一功能

这里根据你们所学语言自行发挥

只需要能够完成：

在运行你写的程序时能够访问数据库、能够查找和改变数据库的数据

